---
version: 1

kind: experiment

framework: pytorch

tags: [dino16, liver_reduced, pretrained-weights False, dataset.input_size=256, batch_size=48, new-collate, PATCH100 RandomPatchSampler]

build:
  image: pytorchlightning/pytorch_lightning:base-xla-py3.7-torch1.12
  build_steps:
    - pip install -r requirements.txt
    - pip install markupsafe==2.0.1 --force
    - pip3 install torch_xla[tpuvm]
    - pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu117

environment:
  resources:
    cpu:
      requests: 4
      limits: 32
    memory:
      requests: 24576
      limits: 32768
    gpu:
      requests: 1
      limits: 1

run:
  cmd: python -m tasks.train \
                wandb.setup.project=self-train \
                dataset=liver_reduced \
                experiment.name=train_dinoLightningModule \
                train=dino_vits16 \
                train.epochs=1000 \
                train.pretrained_weights=False \
                loader.batch_size=48 \
                loader.num_workers=8 \
                wandb=server \
                dataset.input_size=256 \
                loader=patch \
                loader.patch_size=100 
                # loader.patch_mode=random \
                # \ && \
      
    


